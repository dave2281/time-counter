{
  "version": 3,
  "sources": ["../../javascript/deed_show.js"],
  "sourcesContent": ["// Deed show page functionality\nlet timerUpdateInterval = null;\nlet startTime = null;\n\nfunction initDeedShowPage() {\n  // Initialize toggle status indicator\n  const checkbox = document.querySelector('input[type=\"checkbox\"][id*=\"finished\"]');\n  if (checkbox) {\n    checkbox.addEventListener('change', function() {\n      toggleStatusIndicator(this);\n    });\n  }\n\n  // Initialize timer functionality\n  initTimer();  \n}\n\nfunction toggleStatusIndicator(checkbox) {\n  const text = document.getElementById('status-text');\n  const submitBtn = checkbox.form.querySelector('input[type=\"submit\"]');\n  \n  if (checkbox.checked) {\n    text.textContent = 'Done';\n    submitBtn.textContent = 'Complete';\n    submitBtn.className = 'px-4 py-1.5 bg-green-600 hover:bg-green-700 text-white font-medium rounded-md transition-colors text-xs hover-lift';\n  } else {\n    text.textContent = 'Mark Done';\n    submitBtn.textContent = 'Update';\n    submitBtn.className = 'px-4 py-1.5 bg-green-600 hover:bg-green-700 text-white font-medium rounded-md transition-colors text-xs hover-lift';\n  }\n}\n\nfunction initTimer() {\n  const startBtn = document.getElementById('start-timer');\n  const stopBtn = document.getElementById('stop-timer');\n  const display = document.getElementById('timer-display');\n  const indicator = document.getElementById('timer-indicator');\n\n  if (startBtn) {\n    startBtn.addEventListener('click', function() {\n      const deedId = this.dataset.deedId;\n      startTimer(deedId);\n    });\n  }\n\n  if (stopBtn) {\n    stopBtn.addEventListener('click', function() {\n      const deedId = this.dataset.deedId;\n      stopTimer(deedId);\n    });\n  }\n\n  checkTimerStatus();\n}\n\nfunction startTimer(deedId) {  \n  fetch(`/daily_logs/start_timer`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'X-CSRF-Token': document.querySelector('[name=\"csrf-token\"]').content\n    },\n    body: JSON.stringify({ deed_id: deedId })\n  })\n  .then(response => response.json())\n  .then(data => {\n    if (data.success) {\n      startTime = new Date(data.start_time);\n      \n      // Set display to 00:00:00 immediately, then start updating\n      const display = document.getElementById('timer-display');\n      if (display) display.textContent = '00:00:00';\n      \n      updateTimerUI(true);\n      startTimerUpdates();\n    } else {\n      alert('Failed to start timer: ' + (data.error || 'Unknown error'));\n    }\n  })\n  .catch(error => {\n    alert('Error starting timer. Please try again.');\n  });\n}\n\nfunction stopTimer(deedId) {\n  \n  fetch(`/daily_logs/stop_timer`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'X-CSRF-Token': document.querySelector('[name=\"csrf-token\"]').content\n    },\n    body: JSON.stringify({ deed_id: deedId })\n  })\n  .then(response => response.json())\n  .then(data => {\n    if (data.success) {\n      clearInterval(timerUpdateInterval);\n      timerUpdateInterval = null;\n      startTime = null;\n      \n      updateTimerUI(false);\n      \n      if (data.total_time) {\n        const totalTimeEl = document.getElementById('total-time');\n        if (totalTimeEl) totalTimeEl.textContent = data.total_time;\n      }\n      if (data.today_time) {\n        const todayTimeEl = document.getElementById('today-time');\n        if (todayTimeEl) todayTimeEl.textContent = data.today_time;\n      }\n      \n      const display = document.getElementById('timer-display');\n      if (display) display.textContent = '00:00:00';\n      \n    } else {\n      alert('Failed to stop timer: ' + (data.error || 'Unknown error'));\n    }\n  })\n  .catch(error => {\n    alert('Error stopping timer. Please try again.');\n  });\n}\n\nfunction checkTimerStatus() {\n  const deedId = document.getElementById('start-timer')?.dataset.deedId;\n  if (!deedId) return;\n\n  fetch(`/daily_logs/timer_status?deed_id=${deedId}`)\n  .then(response => response.json())\n  .then(data => {\n    if (data.running) {\n      startTime = new Date(data.start_time);\n      updateTimerDisplay();\n      startTimerUpdates();\n      updateTimerUI(true);\n    }\n  });\n}\n\nfunction startTimerUpdates() {\n  timerUpdateInterval = setInterval(updateTimerDisplay, 1000);\n}\n\nfunction updateTimerDisplay() {\n  if (!startTime) return;\n  \n  const now = new Date();\n  const elapsed = Math.floor((now - startTime) / 1000);\n  \n  const hours = Math.floor(elapsed / 3600);\n  const minutes = Math.floor((elapsed % 3600) / 60);\n  const seconds = elapsed % 60;\n  \n  const display = document.getElementById('timer-display');\n  if (display) {\n    display.textContent = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;\n  }\n}\n\nfunction updateTimerUI(isRunning) {  \n  const startBtn = document.getElementById('start-timer');\n  const stopBtn = document.getElementById('stop-timer');\n  const indicator = document.getElementById('timer-indicator');\n  \n  if (isRunning) {\n    if (startBtn) {\n      startBtn.style.display = 'none';\n      startBtn.disabled = true;\n    }\n    if (stopBtn) {\n      stopBtn.style.display = 'inline-block';\n      stopBtn.disabled = false;\n    }\n    if (indicator) {\n      indicator.className = 'w-2 h-2 rounded-full bg-green-500 animate-pulse';\n    }\n  } else {\n    if (startBtn) {\n      startBtn.style.display = 'inline-block';\n      startBtn.disabled = false;\n    }\n    if (stopBtn) {\n      stopBtn.style.display = 'none';\n      stopBtn.disabled = true;\n    }\n    if (indicator) {\n      indicator.className = 'w-2 h-2 rounded-full bg-red-500';\n    }\n  }\n}\n\n// Initialize on page load\ndocument.addEventListener('DOMContentLoaded', initDeedShowPage);\ndocument.addEventListener('turbo:load', initDeedShowPage);\n\n// Cleanup on page leave\ndocument.addEventListener('turbo:before-visit', function() {\n  if (timerUpdateInterval) {\n    clearInterval(timerUpdateInterval);\n    timerUpdateInterval = null;\n  }\n});"],
  "mappings": "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",
  "names": []
}
